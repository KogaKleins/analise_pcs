<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rios - Sistema de An√°lise</title>
    <!-- Sistema de Temas -->
    <link rel="stylesheet" href="../css/themes.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/animations.css">
    <link rel="stylesheet" href="../css/pages.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta name="theme-color" content="#2563EB">
</head>
<body>
    <!-- Background Image Layer -->
    <div class="bg-image-layer"></div>
    
    <!-- Part√≠culas de fundo -->
    <div class="particles" id="particles"></div>
    
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-desktop"></i>
                </div>
                <div class="logo-text">
                    <h1 id="brandName">SISTEMA DE AN√ÅLISE</h1>
                    <span>Gerenciamento de Equipamentos</span>
                </div>
            </div>
            <nav class="nav-menu">
                <a href="../index.html" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>In√≠cio</span>
                </a>
                <a href="clientes.html" class="nav-link">
                    <i class="fas fa-building"></i>
                    <span>Clientes</span>
                </a>
                <a href="relatorios.html" class="nav-link active">
                    <i class="fas fa-file-alt"></i>
                    <span>Relat√≥rios</span>
                </a>
                <a href="sugestoes.html" class="nav-link">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Sugest√µes</span>
                </a>
                <a href="admin.html" class="nav-link admin-only" id="adminLink" style="display: none;">
                    <i class="fas fa-cogs"></i>
                    <span>Admin</span>
                </a>
            </nav>
            <div class="user-menu">
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="userNameDisplay">Usu√°rio</span>
                </div>
                <button class="btn-logout" id="btnLogout" title="Sair">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
            <button class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Page Header -->
    <section class="page-hero">
        <div class="container">
            <div class="page-hero-content">
                <div class="breadcrumb">
                    <a href="../index.html">In√≠cio</a>
                    <i class="fas fa-chevron-right"></i>
                    <span>Relat√≥rios</span>
                </div>
                <h1><i class="fas fa-file-alt"></i> Relat√≥rios</h1>
                <p>Acesse os relat√≥rios detalhados de an√°lise dos equipamentos</p>
            </div>
        </div>
    </section>

    <!-- Relat√≥rios Section -->
    <section class="content-section">
        <div class="container">
            <!-- Relat√≥rios Gerais -->
            <div class="section-block glass-card fade-in-up">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div>
                        <h2>Relat√≥rios Gerais</h2>
                        <p>Vis√£o geral de todos os equipamentos</p>
                    </div>
                </div>
                <div class="reports-grid">
                    <a href="#" class="report-card" onclick="gerarRelatorioPDF(event, 'completo')">
                        <div class="report-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="report-info">
                            <h3>Relat√≥rio Completo</h3>
                            <p>An√°lise de todos os <span id="totalEquipamentos">0</span> equipamentos</p>
                            <span class="report-date"><i class="fas fa-calendar"></i> <span class="current-date">Janeiro 2026</span></span>
                        </div>
                        <div class="report-action">
                            <i class="fas fa-download"></i>
                        </div>
                    </a>
                    <a href="#" class="report-card" onclick="exportarExcel(event)">
                        <div class="report-icon excel">
                            <i class="fas fa-file-excel"></i>
                        </div>
                        <div class="report-info">
                            <h3>Planilha de Dados</h3>
                            <p>Especifica√ß√µes em formato CSV</p>
                            <span class="report-date"><i class="fas fa-calendar"></i> <span class="current-date">Janeiro 2026</span></span>
                        </div>
                        <div class="report-action">
                            <i class="fas fa-download"></i>
                        </div>
                    </a>
                    <a href="#" class="report-card" onclick="gerarRelatorioPDF(event, 'resumo')">
                        <div class="report-icon chart">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <div class="report-info">
                            <h3>Resumo Executivo</h3>
                            <p>Principais pontos e recomenda√ß√µes</p>
                            <span class="report-date"><i class="fas fa-calendar"></i> <span class="current-date">Janeiro 2026</span></span>
                        </div>
                        <div class="report-action">
                            <i class="fas fa-download"></i>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Relat√≥rios por PC -->
            <div class="section-block glass-card fade-in-up" style="animation-delay: 0.1s;">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-desktop"></i>
                    </div>
                    <div>
                        <h2>Relat√≥rios Individuais</h2>
                        <p>Relat√≥rio detalhado de cada computador</p>
                    </div>
                </div>
                <div class="individual-reports" id="individualReports">
                    <!-- Gerado via JS -->
                </div>
            </div>

            <!-- Links Externos -->
            <div class="section-block glass-card fade-in-up" style="animation-delay: 0.2s;">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-external-link-alt"></i>
                    </div>
                    <div>
                        <h2>Links √öteis</h2>
                        <p>Recursos externos e documenta√ß√£o</p>
                    </div>
                </div>
                <div class="links-section">
                    <a href="#" class="external-link-card" target="_blank">
                        <i class="fab fa-google-drive"></i>
                        <span>Google Drive</span>
                        <small>Pasta com documentos</small>
                    </a>
                    <a href="#" class="external-link-card" target="_blank">
                        <i class="fas fa-table"></i>
                        <span>Google Planilhas</span>
                        <small>Planilha principal</small>
                    </a>
                    <a href="#" class="external-link-card" target="_blank">
                        <i class="fas fa-cloud"></i>
                        <span>Backup Online</span>
                        <small>Arquivos de backup</small>
                    </a>
                    <a href="#" class="external-link-card" target="_blank">
                        <i class="fas fa-book"></i>
                        <span>Documenta√ß√£o</span>
                        <small>Manual de uso</small>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <div class="logo">
                        <div class="logo-icon small">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <span>RS CONTABILIDADE</span>
                    </div>
                    <p>An√°lise t√©cnica de equipamentos para otimiza√ß√£o do seu neg√≥cio.</p>
                </div>
                <div class="footer-links">
                    <h4>Navega√ß√£o</h4>
                    <a href="../index.html">In√≠cio</a>
                    <a href="relatorios.html">Relat√≥rios</a>
                    <a href="sugestoes.html">Sugest√µes</a>
                </div>
                <div class="footer-contact">
                    <h4>Desenvolvedor</h4>
                    <p><i class="fas fa-user"></i> Wilmar Izequiel Kleinschmidt</p>
                    <p><i class="fas fa-envelope"></i> kogakleinscleins@gmail.com</p>
                    <p><i class="fas fa-phone"></i> (48) 99185-0299</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; <span class="current-year">2026</span> RS Contabilidade. Sistema desenvolvido por <strong>Wilmar Izequiel Kleinschmidt</strong></p>
            </div>
        </div>
    </footer>

    <script src="../js/theme.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/storage.js"></script>
    <script src="../js/clients.js"></script>
    <script src="../js/particles.js"></script>
    <script>
        // Verificar autentica√ß√£o
        if (!Auth.isAuthenticated()) {
            window.location.href = '../login.html';
        } else {
            // Setup UI
            const session = Auth.getSession();
            document.getElementById('userNameDisplay').textContent = session.name;
            
            if (session.role === 'admin') {
                document.getElementById('adminLink').style.display = 'flex';
            }
            
            document.getElementById('btnLogout').addEventListener('click', () => Auth.logout());
        }

        // Mobile menu
        document.getElementById('menuToggle')?.addEventListener('click', () => {
            document.querySelector('.nav-menu').classList.toggle('active');
        });

        // Header scroll
        window.addEventListener('scroll', () => {
            const header = document.querySelector('.header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Render individual reports from Storage (com suporte a clientes)
        document.addEventListener('DOMContentLoaded', () => {
            // Atualizar ano e data
            document.querySelectorAll('.current-year').forEach(el => el.textContent = new Date().getFullYear());
            
            const meses = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 
                          'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
            const dataAtual = `${meses[new Date().getMonth()]} ${new Date().getFullYear()}`;
            document.querySelectorAll('.current-date').forEach(el => el.textContent = dataAtual);
            
            const container = document.getElementById('individualReports');
            
            // Obter equipamentos (do cliente atual ou global)
            let equipamentos = [];
            if (typeof Clients !== 'undefined') {
                const currentClient = Clients.getCurrent();
                if (currentClient) {
                    equipamentos = Clients.getEquipamentos(currentClient.id);
                    // Atualizar branding
                    const brandName = document.getElementById('brandName');
                    if (brandName) brandName.textContent = currentClient.nome.toUpperCase();
                } else {
                    equipamentos = Storage.getEquipamentos();
                }
            } else {
                equipamentos = Storage.getEquipamentos();
            }
            
            // Atualizar contagem total
            const totalEl = document.getElementById('totalEquipamentos');
            if (totalEl) totalEl.textContent = equipamentos.length;
            
            if (container) {
                if (equipamentos.length === 0) {
                    container.innerHTML = `
                        <div class="empty-reports">
                            <i class="fas fa-folder-open" style="font-size: 48px; color: var(--text-muted); margin-bottom: 16px;"></i>
                            <p style="color: rgba(255,255,255,0.5); padding: 20px; text-align: center;">
                                Nenhum equipamento cadastrado ainda.<br>
                                <small>Adicione equipamentos para gerar relat√≥rios.</small>
                            </p>
                        </div>
                    `;
                } else {
                    container.innerHTML = equipamentos.map(pc => `
                        <a href="#" class="individual-report-item" onclick="verRelatorioIndividual(event, '${pc.id}')">
                            <div class="report-pc-icon">
                                <i class="fas fa-desktop"></i>
                            </div>
                            <div class="report-pc-info">
                                <h4>${pc.nome}</h4>
                                <span>${pc.usuario || 'N/A'} - ${pc.setor || 'N/A'}</span>
                            </div>
                            <span class="status-badge ${pc.status === 'ok' ? 'bom' : pc.status}">
                                ${pc.status === 'bom' || pc.status === 'ok' ? 'Bom' : pc.status === 'atencao' ? 'Aten√ß√£o' : 'Cr√≠tico'}
                            </span>
                            <i class="fas fa-file-pdf"></i>
                        </a>
                    `).join('');
                }
            }
        });
        
        // Fun√ß√µes de relat√≥rio
        function gerarRelatorioPDF(event, tipo) {
            event.preventDefault();
            
            let equipamentos = [];
            if (typeof Clients !== 'undefined') {
                const currentClient = Clients.getCurrent();
                if (currentClient) {
                    equipamentos = Clients.getEquipamentos(currentClient.id);
                } else {
                    equipamentos = Storage.getEquipamentos();
                }
            } else {
                equipamentos = Storage.getEquipamentos();
            }
            
            if (equipamentos.length === 0) {
                alert('Nenhum equipamento cadastrado para gerar relat√≥rio.');
                return;
            }
            
            // Criar conte√∫do do relat√≥rio
            let conteudo = '';
            const clienteNome = typeof Clients !== 'undefined' && Clients.getCurrent() 
                ? Clients.getCurrent().nome 
                : 'Sistema de An√°lise';
            
            if (tipo === 'completo') {
                conteudo = gerarRelatorioCompleto(equipamentos, clienteNome);
            } else {
                conteudo = gerarResumoExecutivo(equipamentos, clienteNome);
            }
            
            // Abrir em nova janela para impress√£o
            const janela = window.open('', '_blank');
            janela.document.write(conteudo);
            janela.document.close();
            janela.print();
        }
        
        function gerarRelatorioCompleto(equipamentos, clienteNome) {
            const dataAtual = new Date().toLocaleDateString('pt-BR');
            const bons = equipamentos.filter(e => e.status === 'bom' || e.status === 'ok').length;
            const atencao = equipamentos.filter(e => e.status === 'atencao').length;
            const criticos = equipamentos.filter(e => e.status === 'critico').length;
            
            return `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Relat√≥rio Completo - ${clienteNome}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; color: #333; }
                        h1 { color: #2563EB; border-bottom: 2px solid #2563EB; padding-bottom: 10px; }
                        h2 { color: #1e40af; margin-top: 30px; }
                        .header { display: flex; justify-content: space-between; margin-bottom: 30px; }
                        .summary { display: flex; gap: 20px; margin: 20px 0; }
                        .summary-item { padding: 15px 25px; border-radius: 8px; text-align: center; }
                        .summary-item.ok { background: #dcfce7; color: #166534; }
                        .summary-item.atencao { background: #fef3c7; color: #92400e; }
                        .summary-item.critico { background: #fee2e2; color: #991b1b; }
                        .summary-item strong { display: block; font-size: 24px; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e5e7eb; }
                        th { background: #f3f4f6; font-weight: 600; }
                        .status { padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
                        .status.bom, .status.ok { background: #dcfce7; color: #166534; }
                        .status.atencao { background: #fef3c7; color: #92400e; }
                        .status.critico { background: #fee2e2; color: #991b1b; }
                        @media print { body { padding: 20px; } }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <div>
                            <h1>üìä Relat√≥rio de Equipamentos</h1>
                            <p><strong>${clienteNome}</strong></p>
                        </div>
                        <div style="text-align: right;">
                            <p>Data: ${dataAtual}</p>
                            <p>Total: ${equipamentos.length} equipamentos</p>
                        </div>
                    </div>
                    
                    <h2>Resumo</h2>
                    <div class="summary">
                        <div class="summary-item ok">
                            <strong>${bons}</strong>
                            Bom Estado
                        </div>
                        <div class="summary-item atencao">
                            <strong>${atencao}</strong>
                            Aten√ß√£o
                        </div>
                        <div class="summary-item critico">
                            <strong>${criticos}</strong>
                            Cr√≠tico
                        </div>
                    </div>
                    
                    <h2>Lista de Equipamentos</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Usu√°rio</th>
                                <th>Setor</th>
                                <th>Processador</th>
                                <th>RAM</th>
                                <th>Armazenamento</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${equipamentos.map(e => `
                                <tr>
                                    <td>${e.nome}</td>
                                    <td>${e.usuario || '-'}</td>
                                    <td>${e.setor || '-'}</td>
                                    <td>${e.processador || '-'}</td>
                                    <td>${e.ram || '-'}</td>
                                    <td>${e.armazenamento || e.storage || '-'}</td>
                                    <td><span class="status ${e.status}">${e.status === 'bom' || e.status === 'ok' ? 'Bom' : e.status === 'atencao' ? 'Aten√ß√£o' : 'Cr√≠tico'}</span></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    
                    <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #e5e7eb; text-align: center; color: #6b7280;">
                        <p>Relat√≥rio gerado automaticamente pelo Sistema de An√°lise de Equipamentos</p>
                        <p>Desenvolvido por Wilmar Izequiel Kleinschmidt</p>
                    </div>
                </body>
                </html>
            `;
        }
        
        function gerarResumoExecutivo(equipamentos, clienteNome) {
            const dataAtual = new Date().toLocaleDateString('pt-BR');
            const bons = equipamentos.filter(e => e.status === 'bom' || e.status === 'ok').length;
            const atencao = equipamentos.filter(e => e.status === 'atencao').length;
            const criticos = equipamentos.filter(e => e.status === 'critico').length;
            const percentBons = ((bons / equipamentos.length) * 100).toFixed(0);
            
            const equipAtencao = equipamentos.filter(e => e.status === 'atencao' || e.status === 'critico');
            
            return `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Resumo Executivo - ${clienteNome}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; color: #333; max-width: 800px; margin: 0 auto; }
                        h1 { color: #2563EB; }
                        .highlight { background: linear-gradient(135deg, #2563EB, #1e40af); color: white; padding: 30px; border-radius: 12px; margin: 20px 0; }
                        .highlight h2 { color: white; margin: 0; }
                        .highlight p { color: rgba(255,255,255,0.9); margin: 10px 0 0; }
                        .metric { display: inline-block; text-align: center; padding: 20px 40px; }
                        .metric strong { display: block; font-size: 36px; }
                        .recommendations { background: #fef3c7; padding: 20px; border-radius: 8px; margin: 20px 0; }
                        .recommendations h3 { color: #92400e; margin-top: 0; }
                        .recommendations ul { margin: 0; padding-left: 20px; }
                        .recommendations li { margin: 8px 0; color: #78350f; }
                        @media print { body { padding: 20px; } }
                    </style>
                </head>
                <body>
                    <h1>üìà Resumo Executivo</h1>
                    <p><strong>${clienteNome}</strong> | ${dataAtual}</p>
                    
                    <div class="highlight">
                        <h2>${percentBons}% dos equipamentos em bom estado</h2>
                        <p>De ${equipamentos.length} equipamentos analisados, ${bons} est√£o funcionando adequadamente.</p>
                    </div>
                    
                    <h2>Vis√£o Geral</h2>
                    <div style="background: #f3f4f6; padding: 20px; border-radius: 8px;">
                        <div class="metric">
                            <strong style="color: #166534;">${bons}</strong>
                            <span>Bom Estado</span>
                        </div>
                        <div class="metric">
                            <strong style="color: #92400e;">${atencao}</strong>
                            <span>Aten√ß√£o</span>
                        </div>
                        <div class="metric">
                            <strong style="color: #991b1b;">${criticos}</strong>
                            <span>Cr√≠tico</span>
                        </div>
                    </div>
                    
                    ${equipAtencao.length > 0 ? `
                        <div class="recommendations">
                            <h3>‚ö†Ô∏è Equipamentos que Necessitam Aten√ß√£o</h3>
                            <ul>
                                ${equipAtencao.map(e => `
                                    <li><strong>${e.nome}</strong> (${e.usuario || 'N/A'}): ${e.recomendacoes || e.observacoes || 'Verificar especifica√ß√µes'}</li>
                                `).join('')}
                            </ul>
                        </div>
                    ` : '<p style="color: #166534;">‚úÖ Todos os equipamentos est√£o em bom estado!</p>'}
                    
                    <div style="margin-top: 40px; text-align: center; color: #6b7280;">
                        <p>Sistema de An√°lise de Equipamentos | Wilmar Izequiel Kleinschmidt</p>
                    </div>
                </body>
                </html>
            `;
        }
        
        function exportarExcel(event) {
            event.preventDefault();
            
            let equipamentos = [];
            if (typeof Clients !== 'undefined') {
                const currentClient = Clients.getCurrent();
                if (currentClient) {
                    equipamentos = Clients.getEquipamentos(currentClient.id);
                } else {
                    equipamentos = Storage.getEquipamentos();
                }
            } else {
                equipamentos = Storage.getEquipamentos();
            }
            
            if (equipamentos.length === 0) {
                alert('Nenhum equipamento cadastrado para exportar.');
                return;
            }
            
            // Criar CSV
            const headers = ['Nome', 'Usu√°rio', 'Setor', 'Processador', 'RAM', 'Armazenamento', 'GPU', 'SO', 'Status', 'Observa√ß√µes', 'Recomenda√ß√µes'];
            const rows = equipamentos.map(e => [
                e.nome || '',
                e.usuario || '',
                e.setor || '',
                e.processador || '',
                e.ram || '',
                e.armazenamento || e.storage || '',
                e.gpu || '',
                e.sistemaOperacional || e.so || '',
                e.status || '',
                e.observacoes || '',
                e.recomendacoes || ''
            ]);
            
            let csv = headers.join(';') + '\\n';
            rows.forEach(row => {
                csv += row.map(cell => `"${cell}"`).join(';') + '\\n';
            });
            
            // Download
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `equipamentos_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        }
        
        function verRelatorioIndividual(event, pcId) {
            event.preventDefault();
            
            let equipamento;
            if (typeof Clients !== 'undefined') {
                const currentClient = Clients.getCurrent();
                if (currentClient) {
                    const equipamentos = Clients.getEquipamentos(currentClient.id);
                    equipamento = equipamentos.find(e => e.id === pcId);
                } else {
                    equipamento = Storage.getEquipamento(pcId);
                }
            } else {
                equipamento = Storage.getEquipamento(pcId);
            }
            
            if (!equipamento) {
                alert('Equipamento n√£o encontrado.');
                return;
            }
            
            const clienteNome = typeof Clients !== 'undefined' && Clients.getCurrent() 
                ? Clients.getCurrent().nome 
                : 'Sistema de An√°lise';
            
            const conteudo = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Relat√≥rio - ${equipamento.nome}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; color: #333; max-width: 800px; margin: 0 auto; }
                        h1 { color: #2563EB; }
                        .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin: 20px 0; }
                        .info-item { background: #f3f4f6; padding: 16px; border-radius: 8px; }
                        .info-item label { font-size: 12px; color: #6b7280; text-transform: uppercase; }
                        .info-item p { margin: 4px 0 0; font-weight: 600; }
                        .status { display: inline-block; padding: 6px 16px; border-radius: 20px; font-weight: 600; }
                        .status.bom, .status.ok { background: #dcfce7; color: #166534; }
                        .status.atencao { background: #fef3c7; color: #92400e; }
                        .status.critico { background: #fee2e2; color: #991b1b; }
                        @media print { body { padding: 20px; } }
                    </style>
                </head>
                <body>
                    <h1>üíª ${equipamento.nome}</h1>
                    <p>${clienteNome} | ${new Date().toLocaleDateString('pt-BR')}</p>
                    
                    <span class="status ${equipamento.status}">${equipamento.status === 'bom' || equipamento.status === 'ok' ? 'Bom Estado' : equipamento.status === 'atencao' ? 'Aten√ß√£o' : 'Cr√≠tico'}</span>
                    
                    <h2>Informa√ß√µes Gerais</h2>
                    <div class="info-grid">
                        <div class="info-item">
                            <label>Usu√°rio</label>
                            <p>${equipamento.usuario || 'N√£o informado'}</p>
                        </div>
                        <div class="info-item">
                            <label>Setor</label>
                            <p>${equipamento.setor || 'N√£o informado'}</p>
                        </div>
                    </div>
                    
                    <h2>Especifica√ß√µes</h2>
                    <div class="info-grid">
                        <div class="info-item">
                            <label>Processador</label>
                            <p>${equipamento.processador || 'N√£o informado'}</p>
                        </div>
                        <div class="info-item">
                            <label>Mem√≥ria RAM</label>
                            <p>${equipamento.ram || 'N√£o informado'}</p>
                        </div>
                        <div class="info-item">
                            <label>Armazenamento</label>
                            <p>${equipamento.armazenamento || equipamento.storage || 'N√£o informado'}</p>
                        </div>
                        <div class="info-item">
                            <label>Placa de V√≠deo</label>
                            <p>${equipamento.gpu || 'N√£o informado'}</p>
                        </div>
                        <div class="info-item">
                            <label>Sistema Operacional</label>
                            <p>${equipamento.sistemaOperacional || equipamento.so || 'N√£o informado'}</p>
                        </div>
                    </div>
                    
                    ${equipamento.observacoes ? `
                        <h2>Observa√ß√µes</h2>
                        <p>${equipamento.observacoes}</p>
                    ` : ''}
                    
                    ${equipamento.recomendacoes ? `
                        <h2>Recomenda√ß√µes</h2>
                        <p style="background: #fef3c7; padding: 16px; border-radius: 8px; color: #78350f;">${equipamento.recomendacoes}</p>
                    ` : ''}
                    
                    <div style="margin-top: 40px; text-align: center; color: #6b7280; border-top: 1px solid #e5e7eb; padding-top: 20px;">
                        <p>Sistema de An√°lise de Equipamentos | Wilmar Izequiel Kleinschmidt</p>
                    </div>
                </body>
                </html>
            `;
            
            const janela = window.open('', '_blank');
            janela.document.write(conteudo);
            janela.document.close();
        }
    </script>
</body>
</html>
